<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">










<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
<meta http-equiv="Content-Language" content="ja" /> 
<meta http-equiv="Content-Style-Type" content="text/css" /> 
<title>Doma - Genタスク</title>
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/main.css" media="screen,projection" />
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/print.css" media="print" />
<link href="../css/maven-base.css" type="text/css" rel="stylesheet" media="screen" />
<link href="../css/maven-theme.css" type="text/css" rel="stylesheet" media="screen" />
<link href="../css/prettify.css" type="text/css" rel="stylesheet" media="screen" />
<script type="text/javascript" src="../js/prettify.js"></script>
</head>

<body onload="prettyPrint()">

<div id="wrapper">

<div id="header">

<div class="line"><span class="hide">spacer</span></div>

<div id="logo"><h1 id="h01" class="hide">The Seasar Project</h1><a href="http://www.seasar.org/" alt="The Seasar Project" title="The Seasar Project"><img src="http://www.seasar.org/images/seasar_logo_blue.gif" alt="The Seasar Project" width="390" height="180" /></a></div>

<div id="tool">

<h2><a href="http://search.seasar.org/">Site Search</a></h2>

<form id="search" action="http://search.seasar.org/">
<div>
	<input id="search_phrase" type="text" name="phrase" size="20" />
	<input type="hidden" name="perpage" value="30" />
	<input type="hidden" name="enc" value="UTF-8" />
	<input id="search_go" type="submit" value="Search" />
</div>
</form>

<h2>Seasar Banner</h2>
            <a href="http://www.seasar.org/" id="bannerLeft">
    
                                    <img src="http://www.seasar.org/images/seasar_banner.gif" alt="" />
    
            </a>
      
</div>

<div id="navi">
	<p id="navi_left">  
          <a href="http://www.seasar.org/">Seasar</a>
              &gt;
      
          <a href="../index.html">Doma</a>
          </p>
	<p id="navi_right"><a href="../../en/">English</a> | <a href="../../ja/">Japanese</a></p>
</div>

</div><!-- header -->

<div id="contents_left">
           
  

  
    
  
  
                   <h2>About</h2>
        <ul>
              
    <li class="none">
              <a href="../index.html">ホーム</a>
        </li>
              
    <li class="none">
              <a href="../overview.html">概要</a>
        </li>
              
    <li class="none">
              <a href="../downloads.html">ダウンロード</a>
        </li>
              
    <li class="none">
              <a href="https://www.seasar.org/issues/browse/DOMA">課題追跡</a>
        </li>
              
    <li class="none">
              <a href="https://www.seasar.org/issues/browse/DOMA#selectedTab=com.atlassian.jira.plugin.system.project%3Achangelog-panel">変更履歴</a>
        </li>
              
    <li class="none">
              <a href="https://ml.seasar.org/mailman/listinfo/seasar-user">メーリングリスト</a>
        </li>
              
    <li class="none">
              <a href="../faq.html">よくある質問</a>
        </li>
          </ul>
          <h2>ドキュメント</h2>
        <ul>
              
    <li class="none">
              <a href="../setup.html">セットアップ</a>
        </li>
              
    <li class="none">
              <a href="../quick_start.html">クイックスタート</a>
        </li>
              
                
              
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="../tutorial/index.html">チュートリアル</a>
              </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="../reference/index.html">リファレンス</a>
              </li>
              
    <li class="none">
              <a href="../jpetstore.html">デモアプリ - Doma JPetStore</a>
        </li>
              
                
              
      
            
      
            
            
            
      
                    
            <li class="expanded">
              <a href="../extension/index.html">開発支援ツール</a>
                <ul>
                  
    <li class="none">
              <a href="../extension/doma_tools.html">Doma Tools</a>
        </li>
                  
                
              
            
            
      
              
            <li class="expanded">
              <a href="../extension/doma_gen.html">Doma-Gen</a>
                <ul>
                  
    <li class="none">
              <strong>Gen</strong>
        </li>
                  
    <li class="none">
              <a href="../extension/doma_gen_gentest_task.html">GenTest</a>
        </li>
              </ul>
        </li>
              </ul>
        </li>
              
    <li class="none">
              <a href="http://www.seasar.org/wiki/index.php?DomaUpdateOperationLog">移行ガイド</a>
        </li>
          </ul>
          <h2>Javadocs</h2>
        <ul>
              
    <li class="none">
              <a href="../apidocs/index.html">Doma</a>
        </li>
              
    <li class="none">
              <a href="../extension/doma-gen/apidocs/index.html">Doma-Gen</a>
        </li>
          </ul>
          <h2>プロジェクト文書</h2>
        <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="../project-info.html">プロジェクト情報</a>
              </li>
          </ul>
                                       <a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy" name="poweredBy">
            <img alt="Built by Maven" src="../images/logos/maven-feather.png" />
          </a>
                       
  

  
    
  
  
  </div><!-- contents_left -->

<div id="contents_center">

<div id="article">
<div class="section"><h2><a name="目次"></a>目次</h2>
<ul><li><a href="#概要">概要</a></li>
<li><a href="#パラメータ">パラメータ</a><ul><li><a href="#トップレベルパラメータ">トップレベルパラメータ</a></li>
<li><a href="#ネストした要素として指定されるパラメータ">ネストした要素として指定されるパラメータ</a><ul><li><a href="#EntityConfig">EntityConfig</a></li>
<li><a href="#DaoConfig">DaoConfig</a></li>
<li><a href="#SqlConfig">SqlConfig</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#使用例">使用例</a><ul><li><a href="#エンティティクラスに共通のスーパークラスを指定する">エンティティクラスに共通のスーパークラスを指定する</a></li>
<li><a href="#エンティティリスナーに共通のスーパークラスを指定する">エンティティリスナーに共通のスーパークラスを指定する</a></li>
<li><a href="#エンティティプロパティのクラス名を指定する">エンティティプロパティのクラス名を指定する</a></li>
<li><a href="#独自のテンプレートファイルを使用する">独自のテンプレートファイルを使用する</a></li>
<li><a href="#独自のSQLファイルを生成する">独自のSQLファイルを生成する</a></li>
<li><a href="#生成するJavaファイルに共通のヘッダーとしてコピーライトを含める">生成するJavaファイルに共通のヘッダーとしてコピーライトを含める</a></li>
<li><a href="#生成するJavaファイルにauthorを指定する">生成するJavaファイルにauthorを指定する</a></li>
</ul>
</li>
</ul>
</div>
<div class="section"><h2><a name="概要"></a>概要</h2>
<p>
				Genタスクは、データベースに接続してメタデータを読み取り、その情報を基にエンティティクラス、エンティティリスナークラス、Daoインタフェース、SQLのコードを生成します。
			</p>
<p>
				Genタスクを利用するには、次のようにtaskdefタグとtypedefタグを使ってタスクとデータ型を定義する必要があります。
			</p>
<div class="source"><pre>&lt;taskdef name=&quot;gen&quot; classname=&quot;org.seasar.doma.extension.gen.task.Gen&quot; classpathref=&quot;classpath&quot; loaderref=&quot;loader&quot;/&gt;
&lt;typedef name=&quot;entityConfig&quot; classname=&quot;org.seasar.doma.extension.gen.task.EntityConfig&quot; loaderref=&quot;loader&quot;/&gt;
&lt;typedef name=&quot;daoConfig&quot; classname=&quot;org.seasar.doma.extension.gen.task.DaoConfig&quot; loaderref=&quot;loader&quot;/&gt;
&lt;typedef name=&quot;sqlConfig&quot; classname=&quot;org.seasar.doma.extension.gen.task.SqlConfig&quot; loaderref=&quot;loader&quot;/&gt;</pre>
</div>
<p>
				taskdefのclasspathref属性には、Doma-Gen、FreeMarker、JDBCドライバのjarファイルが参照されるように設定してください（Doma本体のjarファイルは不要です）。
			</p>
<p>
				定義したタスクとデータ型は次のように使用します。
			</p>
<div class="source"><pre>&lt;target name=&quot;gen&quot;&gt;
    &lt;gen
        dialectName=&quot;${dialectName}&quot;
        driverClassName=&quot;${driverClassName}&quot;
        url=&quot;${url}&quot;
        user=&quot;${user}&quot;
        password=&quot;${password}&quot;&gt;
        &lt;entityConfig
            destdir=&quot;${javaDestDir}&quot;
            packageName=&quot;${entityPackageName}&quot;
        /&gt;
        &lt;daoConfig
            destdir=&quot;${javaDestDir}&quot;
            packageName=&quot;${daoPackageName}&quot;
            configClassName=&quot;${configClassName}&quot;
        /&gt;
        &lt;sqlConfig
            destdir=&quot;${sqlDestDir}&quot;
        /&gt;
    &lt;/gen&gt;
&lt;/target&gt;</pre>
</div>
<p>
				生成されるコードは次のようになります。
			</p>
<p>
				エンティティクラスです。
			</p>
<div class="source"><pre>@Entity(listener = AddressListener.class)
@Table(name = &quot;ADDRESS&quot;)
public class Address {

    @Id
    @Column(name = &quot;ADDRESS_ID&quot;)
    Integer addressId;

    @Column(name = &quot;STREET&quot;)
    String street;

    @Version
    @Column(name = &quot;VERSION&quot;)
    Integer version;
    ...
}</pre>
</div>
<p>
				エンティティリスナークラスです。
			</p>
<div class="source"><pre>public class AddressListener implements EntityListener&lt;Address&gt; {

    @Override
    public void preInsert(Address entity, PreInsertContext&lt;Address&gt; context) {
    }

    @Override
    public void preUpdate(Address entity, PreUpdateContext&lt;Address&gt; context) {
    }

    @Override
    public void preDelete(Address entity, PreDeleteContext&lt;Address&gt; context) {
    }

    @Override
    public void postInsert(Address entity, PostInsertContext&lt;Address&gt; context) {
    }

    @Override
    public void postUpdate(Address entity, PostUpdateContext&lt;Address&gt; context) {
    }

    @Override
    public void postDelete(Address entity, PostDeleteContext&lt;Address&gt; context) {
    }
}</pre>
</div>
<p>
				Daoインタフェースです。
			</p>
<div class="source"><pre>@Dao(config = AppConfig.class)
public interface AddressDao {

    @Select
    Address selectById(Integer addressId);

    @Select(ensureResult = true)
    Address selectByIdAndVersion(Integer addressId, Integer version);

    @Insert
    int insert(Address entity);

    @Update
    int update(Address entity);

    @Delete
    int delete(Address entity);
}</pre>
</div>
<p>
				Daoデリゲートクラスです。
			</p>
<div class="source"><pre>public class AddressDaoDelegate {

    private final Config config;

    private final AddressDao dao;

    public AddressDaoDelegate(Config config, AddressDao dao) {
        if (config == null) {
            throw new NullPointerException(&quot;config&quot;);
        }
        if (dao == null) {
            throw new NullPointerException(&quot;dao&quot;);
        }
        this.config = config;
        this.dao = dao;
    }

    public int insert(Address entity) {
        return -1;
    }

    public int update(Address entity) {
        return -1;
    }

    public int delete(Address entity) {
        return -1;
    }
}</pre>
</div>
<p>
				識別子を条件として検索するSQLです。
			</p>
<div class="source"><pre>select
    ADDRESS_ID,
    STREET,
    VERSION
from
    ADDRESS
where
    ADDRESS_ID = /* addressId */1</pre>
</div>
<p>
				識別子とバージョンを条件として検索するSQLです。
			</p>
<div class="source"><pre>select
    ADDRESS_ID,
    STREET,
    VERSION
from
    ADDRESS
where
    ADDRESS_ID = /* addressId */1
    and
    VERSION = /* version */1
    </pre>
</div>
</div>
<div class="section"><h2><a name="パラメータ"></a>パラメータ</h2>
<div class="section"><h3><a name="トップレベルパラメータ"></a>トップレベルパラメータ</h3>
<p>
					トップレベルパラメータの定義は次の通りです。
				</p>
<table class="bodyTable"><tr class="a"><th>属性</th>
<th>説明</th>
<th>デフォルト値</th>
<th>必須</th>
</tr>
<tr class="b"><td>dialectName</td>
<td>接続するRDBMSの方言名です。次のうちのどれかを指定できます。&quot;h2&quot;、&quot;hsqldb&quot;、&quot;mysql&quot;、&quot;postgres&quot;、&quot;oracle&quot;、&quot;db2&quot;、&quot;mssql2008&quot;、&quot;mssql&quot;。この名前に対応するクラスは、Genタスクを実行するクラスパスに通されている必要があります。</td>
<td>-</td>
<td><b>genDialectClassNameが指定されていない場合YES</b></td>
</tr>
<tr class="a"><td>genDialectClassName</td>
<td>接続するRDBMSの方言クラス名です。<code>org.seasar.doma.extension.gen.dialect.GenDialect</code>の実装クラスでなければいけません。dialectNameの指定により利用できる組み込みの方言クラス以外を利用する場合に指定します。指定するクラスは、Genタスクを実行するクラスパスに通されている必要があります。</td>
<td>-</td>
<td><b>dialectNameが指定されていない場合YES</b></td>
</tr>
<tr class="b"><td>driverClassName</td>
<td>JDBCドライバクラス名です。<code>java.sql.Driver</code>の実装クラスでなければいけません。</td>
<td>-</td>
<td><b><b>YES</b></b></td>
</tr>
<tr class="a"><td>url</td>
<td>JDBC接続URLです。</td>
<td>-</td>
<td><b>YES</b></td>
</tr>
<tr class="b"><td>user</td>
<td>JDBC接続ユーザーです。</td>
<td>-</td>
<td><b>YES</b></td>
</tr>
<tr class="a"><td>password</td>
<td>JDBC接続パスワードです。</td>
<td>-</td>
<td><b>YES</b></td>
</tr>
<tr class="b"><td>schemaName</td>
<td>対象とするテーブルが所属するスキーマ名です。指定しない場合、JDBC接続ユーザーでアクセス可能な全スキーマが対象になります。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="a"><td>tableNamePattern</td>
<td>対象とするテーブル名の正規表現です。大文字小文字の違いは考慮されません。</td>
<td>&quot;.*&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>ignoredTableNamePattern</td>
<td>対象としないテーブル名の正規表現です。大文字小文字の違いは考慮されません。</td>
<td>&quot;.*\$.*&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>tableTypes</td>
<td>対象とするテーブルの型です。複数の値を空白またはカンマで区切って指定できます。たとえば、テーブルに加えビューを対象にしたい場合、&quot;TABLE, VIEW&quot;と指定します。この値は、java.sql.DatabaseMetaDataクラスのgetTablesメソッドの最後のパラメータに渡されます。</td>
<td>&quot;TABLE&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>versionColumnNamePattern</td>
<td>エンティティのプロパティに@Versionを付与するカラム名の正規表現です。大文字小文字の違いは考慮されません。</td>
<td>&quot;VERSION([_]?NO)?&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>templateEncoding</td>
<td>テンプレートファイルのエンコーディングです。</td>
<td>&quot;UTF-8&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>templatePrimaryDir</td>
<td>テンプレートファイルを検索する際の優先ディレクトリです。独自テンプレートファイルを使用する場合に指定します。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="a"><td>globalFactoryClassName</td>
<td>このタスクで使用されるインスタンスを生成するファクトリの完全修飾名です。<code>org.seasar.doma.extension.gen.GlobalFactory</code>の実装クラスでなければいけません。このタスクの振る舞いをカスタマイズする場合に指定します。</td>
<td>&quot;org.seasar.doma.extension.gen.GlobalFactory&quot;</td>
<td>NO</td>
</tr>
</table>
</div>
<div class="section"><h3><a name="ネストした要素として指定されるパラメータ"></a>ネストした要素として指定されるパラメータ</h3>
<h4><a name="EntityConfig"></a>EntityConfig</h4>
<p>
					エンティティクラスの生成に関する設定を表すデータ型です。
				</p>
<p>
					このデータ型を使用するとエンティティクラスとエンティティリスナークラスを生成できます。エンティティクラスとエンティティリスナーは同じパッケージに生成されます。
				</p>
<p>
					EntityConfigのパラメータ定義は次のとおりです。
				</p>
<table class="bodyTable"><tr class="b"><th>属性</th>
<th>説明</th>
<th>デフォルト値</th>
<th>必須</th>
</tr>
<tr class="a"><td>generate</td>
<td>&quot;true&quot;の場合、エンティティクラスとエンティティリスナーのJavaコードを生成します。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>destDir</td>
<td>Javaファイルの出力先ディレクトリです。</td>
<td>&quot;src&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>encoding</td>
<td>Javaファイルのエンコーディングです。</td>
<td>&quot;UTF-8&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>overwrite</td>
<td>&quot;true&quot;の場合、エンティティクラスのJavaコードを上書きします。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>overwriteListener</td>
<td>&quot;true&quot;の場合、エンティティリスナークラスのJavaコードを上書きします。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>packageName</td>
<td>エンティティクラスのパッケージ名です。</td>
<td>&quot;example.entity&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>superclassName</td>
<td>エンティティクラスのスーパークラスの完全修飾名です。生成されるエンティティクラスはここに指定したスーパークラスを継承します。指定するクラスは、Genタスクを実行するクラスパスに通されている必要があります。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="b"><td>listenerSuperclassName</td>
<td>エンティティリスナーのスーパークラスの完全修飾名です。生成されるエンティティリスナークラスはここに指定したスーパークラスを継承します。ここに指定するクラスは1つの型パラメータを受け取ります。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="a"><td>namingType</td>
<td>ネーミング規約です。&quot;none&quot;、 &quot;snake_upper_case&quot;、 &quot;snake_lower_case&quot;、&quot;upper_case&quot;、&quot;lower_case&quot;のいずれかの値を指定できます。@Entityのnaming要素に使用されます。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="b"><td>entityPropertyClassNamesFile</td>
<td>エンティティプロパティのクラス名を解決するためのファイルです。形式は、キーをエンティティプロパティ名の正規表現、値をクラスの完全修飾名とするプロパティファイル形式です。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="a"><td>generationType</td>
<td>識別子を生成する方法です。&quot;identity&quot;、 &quot;sequence&quot;、 &quot;table&quot;のいずれかの値を指定できます。使用するRDBMSがサポートしていない場合、&quot;identity&quot;や&quot;sequence&quot;を指定するとエラーが発生します。この指定は、エンティティに対応するテーブルが単一の主キーを持つ場合にのみ有効です。複数の主キーがある場合、この指定は無視されます。@GeneratedValueのstrategy要素に使用されます。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="b"><td>initialValue</td>
<td>識別子の初期値です。generationTypeに&quot;sequence&quot;もしくは&quot;table&quot;を指定した場合にのみ有効です。@SequenceGeneratorや@TableGeneratorのinitialValue要素に指定されます。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="a"><td>allocationSize</td>
<td>識別子の割り当てサイズです。generationTypeに&quot;sequence&quot;もしくは&quot;table&quot;を指定した場合にのみ有効です。@SequenceGeneratorや@TableGeneratorのallocationSize要素に指定されます。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="b"><td>useAccessor</td>
<td>&quot;true&quot;の場合、エンティティクラスにアクセサメソッドを付与します。&quot;false&quot;の場合、エンティティのプロパティはpublicフィールドになります。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>useListener</td>
<td>&quot;true&quot;の場合、エンティティリスナークラスのJavaコードを生成し、@Entityのlistener要素にエンティティリスナークラスを指定します。&quot;false&quot;の場合、エンティティリスナークラスのJavaコードは生成されません。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>useUtilDate</td>
<td>&quot;true&quot;の場合、エンティティクラスのプロパティの日付、時刻、タイムスタンプ型にjava.util.Dateを使用します。&quot;false&quot;の場合、日付、時刻、タイムスタンプ型にjava.sql.Date、java.sql.Time、java.sql.Timestampを使用します。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>showDbComment</td>
<td>&quot;true&quot;の場合、データベースに対するコメントをエンティティのJavadocコメントに適用します。テーブルへのコメントはクラスのJavadocコメントに反映され、カラムへのコメントはプロパティのJavadocコメントに反映されます。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>showCatalogName</td>
<td>&quot;true&quot;の場合、@Tableのcatalog属性にカタログ名を明記します。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>showSchemaName</td>
<td>&quot;true&quot;の場合、@Tableのschema属性にスキーマ名を明記します。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>showTableName</td>
<td>&quot;true&quot;の場合、@Tableのname属性にテーブル名を明記します。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>showColumnName</td>
<td>&quot;true&quot;の場合、@Columnのname属性にカラム名を明記します。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>originalStatesPropertyName</td>
<td>ここに指定した名前のプロパティに、@OriginalStatesを注釈します。テーブルのカラムから作られる永続的なプロパティと名前が重複しないように注意してください。指定しない場合、@OriginalStatesは使用されません。</td>
<td>-</td>
<td>NO</td>
</tr>
</table>
<h4><a name="DaoConfig"></a>DaoConfig</h4>
<p>
					Daoインタフェースの生成に関する設定を表すデータ型です。
				</p>
<p>
					このデータ型を使用するとエンティティごとに1つのDaoインタフェースとDaoデリゲートクラスを生成できます。
				</p>
<p>
					DaoConfigのパラメータ定義は次のとおりです。
				</p>
<table class="bodyTable"><tr class="a"><th>属性</th>
<th>説明</th>
<th>デフォルト値</th>
<th>必須</th>
</tr>
<tr class="b"><td>overwrite</td>
<td>&quot;true&quot;の場合、DaoインタフェースのJavaコードを上書きします。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>overwriteDelegate</td>
<td>&quot;true&quot;の場合、DaoデリゲートクラスのJavaコードを上書きします。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>destDir</td>
<td>Javaファイルの出力先ディレクトリです。</td>
<td>&quot;src&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>encoding</td>
<td>Javaファイルのエンコーディングです。</td>
<td>&quot;UTF-8&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>generate</td>
<td>&quot;true&quot;の場合、DaoインタフェースのJavaコードを生成します。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>packageName</td>
<td>Daoインタフェースのパッケージ名です。</td>
<td>&quot;example.dao&quot;</td>
<td>NO</td>
</tr>
<tr class="b"><td>suffix</td>
<td>Daoインタフェース名のサフィックスです。Daoインタフェースの名前はエンティティクラス名に、この値をサフィックスしたものになります。</td>
<td>&quot;Dao&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>configClassName</td>
<td>設定クラスの完全修飾名です。@Daoのconfig要素に使用されます。</td>
<td>-</td>
<td>NO</td>
</tr>
<tr class="b"><td>useDelegate</td>
<td>&quot;true&quot;の場合、DaoデリゲートクラスのJavaコードを生成します。&quot;false&quot;の場合、生成しません。</td>
<td>&quot;false&quot;</td>
<td>NO</td>
</tr>
</table>
<h4><a name="SqlConfig"></a>SqlConfig</h4>
<p>
					SQLファイルの生成に関する設定を表すデータ型です。
				</p>
<p>
					このデータ型を使用するとエンティティごとにデフォルトで2つのSQLファイルを生成できます。
					生成されるSQLは次のものです。
				</p>
<ul><li>条件に識別子を指定して検索するSQL</li>
<li>条件に識別子とバージョンを指定して検索するSQL</li>
</ul>
<p>
					ただし、エンティティが識別子を持たない場合、SQLファイルは生成されません。
					また、エンティティがバージョンを持たない場合は、条件にバージョンを指定するSQLは生成されません。
				</p>
<p>
					テンプレートを用意することで、独自のSQLファイルを生成できます。詳細は、<a href="#独自のSQLファイルを生成する">独自のSQLファイルを生成する</a>を参照してください。
				</p>
<p>
					SqlConfigのパラメータ定義は次のとおりです。
				</p>
<table class="bodyTable"><tr class="a"><th>属性</th>
<th>説明</th>
<th>デフォルト値</th>
<th>必須</th>
</tr>
<tr class="b"><td>generate</td>
<td>&quot;true&quot;の場合、SQLファイルを生成します。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
<tr class="a"><td>destDir</td>
<td>SQLファイルの出力先ディレクトリです。ファイルは、<a href="../reference/sqlfile.html#ファイル名の形式">ファイル名の形式</a>に則って出力されます。ここに指定したディレクトリを基点にMETA-INF以下のディレクトリが作成されます。</td>
<td>src</td>
<td>NO</td>
</tr>
<tr class="b"><td>overwrite</td>
<td>&quot;true&quot;の場合、SQLファイルを上書きします。</td>
<td>&quot;true&quot;</td>
<td>NO</td>
</tr>
</table>
</div>
</div>
<div class="section"><h2><a name="使用例"></a>使用例</h2>
<div class="section"><h3><a name="エンティティクラスに共通のスーパークラスを指定する"></a>エンティティクラスに共通のスーパークラスを指定する</h3>
<p>
					EntityConfigのsuperclassName属性に、エンティティクラスに共通のスーパークラスの名前を指定できます。
					たとえば、エンティティに対応するすべてのテーブルにCREATE_TIMESTAMPとUPDATE_TIMESTAMPというカラムが定義されている場合、
					次のようなクラスを作成し、すべてのエンティティのスーパークラスに指定できます。
				</p>
<div class="source"><pre>@Entity
public abstract class Common {
    Date createTimestamp;
    Date updateTimestamp;
    ...
}</pre>
</div>
<p>
					スーパークラス名をsuperclassName属性に指定します。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;&gt;
    &lt;entityConfig
        superclassName=&quot;example.Common&quot;
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
<p>
					タスクを実行するとexample.Commonを継承した次のようなクラスが生成されます。
				</p>
<div class="source"><pre>@Entity
public class Employee extends Common {
    @Id
    Integer id;
    String name;
    ...
}</pre>
</div>
</div>
<div class="section"><h3><a name="エンティティリスナーに共通のスーパークラスを指定する"></a>エンティティリスナーに共通のスーパークラスを指定する</h3>
<p>
					EntityConfigのlistenerSuperclassName属性に、エンティティリスナーに共通のスーパークラスの名前を指定できます。
					通常、EntityConfigのsuperclassName属性と合わせて使用します。
					たとえば、次のようにエンティティクラスに共通のスーパークラスとそのクラスを型パラメータとして受け取るエンティティリスナーの2つを用意します。
				</p>
<div class="source"><pre>@Entity
public abstract class Common {
    Date createTimestamp;
    Date updateTimestamp;
    ...
}</pre>
</div>
<div class="source"><pre>public class CommonListener&lt;T extends Common&gt; implements EntityListener&lt;T&gt; {
    public void preInsert(T entity, PreInsertContext&lt;T&gt; context) {...}
    public void preUpdate(T entity, PreUpdateContext&lt;T&gt; context) {...}
    public void preDelete(T entity, PreDeleteContext&lt;T&gt; context) {...}
    public void postInsert(T entity, PostInsertContext&lt;T&gt; context) {...}
    public void postUpdate(T entity, PostUpdateContext&lt;T&gt; context) {...}
    public void postDelete(T entity, PostDeleteContext&lt;T&gt; context) {...}
}</pre>
</div>
<p>
					これらのクラス名をsuperclassName属性とlistenerSuperclassName属性に指定します。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;&gt;
    &lt;entityConfig
        superclassName=&quot;example.Common&quot;
        listenerSuperclassName=&quot;example.CommonListener&quot;
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
<p>
					タスクを実行するとexample.CommonListenerを継承した次のようなクラスが生成されます。
				</p>
<div class="source"><pre>public class EmployeeListener extends CommonListener&lt;Employee&gt; {
}</pre>
</div>
</div>
<div class="section"><h3><a name="エンティティプロパティのクラス名を指定する"></a>エンティティプロパティのクラス名を指定する</h3>
<p><a href="../reference/domain.html">ドメインクラス</a>を使用する場合など、特定のエンティティプロパティに対しクラス名を指定したいことがあります。
				</p>
<p>
					クラス名の指定は、プロパティファイルで行います。
					キーは、エンティティプロパティの完全修飾名を正規表現で表したもの、値はマッピングしたいクラスの完全修飾名です。
					エンティティプロパティの完全修飾名とは、「エンティティクラスの完全修飾名」と「エンティティプロパティ名」を「@」で連結したものです。
					たとえば、EmployeeエンティティクラスのエンティティプロパティemployeeNameの完全修飾名は、「example.entity.Employee@employeeName」です。
					Employeeエンティティクラスの中でエンティティプロパティ名が「Name」で終わるものを「example.domain.Name」クラスにマッピングさせるには、次のように記述します。
				</p>
<div class="source"><pre>example.entity.Employee@.*Name$=example.domain.Name</pre>
</div>
<p>
					プロパティ名の部分を正規表現で示しています。正規表現はプロパティ名に対してのみ使用できます（@より左のクラス名は必ず完全修飾名でなければいけません）。
				</p>
<p>
					生成されるエンティティクラスでは、次のようにemployeeNameプロパティの型が「example.domain.Name」になります。
				</p>
<div class="source"><pre>import example.domain.Name;

@Entity
public class Employee extends Common {
    @Id
    Integer id;
    Name employeeName;
    ...
}</pre>
</div>
<p>
					Employeeエンティティクラスに限らず、すべてのエンティティクラスを対象にエンティティプロパティ名が「Name」で終わるものを「example.domain.Name」クラスにマッピングさせたい場合は次のように記述します。
				</p>
<div class="source"><pre>.*Name$=example.domain.Name</pre>
</div>
<p>
					プロパティファイルは、エンティティプロパティごとに上から順番に評価され、正規表現がマッチした時点で評価を終えます。
					どの行にもマッチしない場合、クラス名はデフォルトのクラス名になります。
				</p>
<p>
					プロパティファイルはentityPropertyClassNamesFile属性に指定できます。（ここではプロパティファイルの名前をentityPropertyClassNames.propertiesとします。）
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;&gt;
    &lt;entityConfig
        entityPropertyClassNamesFile=&quot;entityPropertyClassNames.properties&quot;
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
</div>
<div class="section"><h3><a name="独自のテンプレートファイルを使用する"></a>独自のテンプレートファイルを使用する</h3>
<p>
					Doma-Genのテンプレートは、配布ファイルのresources/templateディレクトリ以下にあります。
					エンティティクラスのテンプレートはentity.ftl、エンティティリスナークラスのテンプレートはentityListener.ftl、Daoインタフェースのテンプレートはdao.ftl、DaoデリゲートクラスのテンプレートはdaoDelegate.ftlになります。
					また、識別子を条件に検索するSQLのテンプレートはselectById.sql.ftl、識別子とバージョンを条件に検索するSQLのテンプレートはselectByIdAndVersion.sql.ftlです。
					これをコピーして、修正を加えるのが良いでしょう。
					テンプレートの記述方法については<a class="externalLink" href="http://freemarker.org/">FreeMarker</a>のドキュメントを参照してください。
				</p>
<p>
					修正したテンプレートファイルは、ファイル名を変更せずにtemplateFilePrimaryDir属性に指定するディレクトリに配置します。
					mytemplateディレクトリに配置する場合、templatePrimaryDir属性にmytemplateを指定します。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;
    templatePrimaryDir=&quot;mytemplate&quot;&gt;
    &lt;entityConfig
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
<p>
					それぞれのテンプレートは、特定のデータモデルを参照します。
					テンプレートとデータモデルクラスの対応付けを以下に示します。
				</p>
<table class="bodyTable"><tr class="a"><th>テンプレート</th>
<th>データモデルクラス</th>
<th>生成物</th>
</tr>
<tr class="b"><td>entity.ftl</td>
<td><a href="doma-gen/apidocs/org/seasar/doma/extension/gen/EntityDesc.html">org.seasar.doma.extension.gen.EntityDesc</a></td>
<td>エンティティクラスのJavaファイル</td>
</tr>
<tr class="a"><td>entityListener.ftl</td>
<td><a href="doma-gen/apidocs/org/seasar/doma/extension/gen/EntityListenerDesc.html">org.seasar.doma.extension.gen.EntityListenerDesc</a></td>
<td>エンティティリスナークラスのJavaファイル</td>
</tr>
<tr class="b"><td>dao.ftl</td>
<td><a href="doma-gen/apidocs/org/seasar/doma/extension/gen/DaoDesc.html">org.seasar.doma.extension.gen.DaoDesc</a></td>
<td>DaoインタフェースのJavaファイル</td>
</tr>
<tr class="a"><td>daoDelegate.ftl</td>
<td><a href="doma-gen/apidocs/org/seasar/doma/extension/gen/DaoDelegateDesc.html">org.seasar.doma.extension.gen.DaoDelegateDesc</a></td>
<td>DaoデリゲートクラスのJavaファイル</td>
</tr>
<tr class="b"><td>xxx.sql.ftl (xxxは任意の名称)</td>
<td><a href="doma-gen/apidocs/org/seasar/doma/extension/gen/SqlDesc.html">org.seasar.doma.extension.gen.SqlDesc</a></td>
<td>SQLファイル</td>
</tr>
</table>
</div>
<div class="section"><h3><a name="独自のSQLファイルを生成する"></a>独自のSQLファイルを生成する</h3>
<p>
					テンプレートを用意することで、独自のSQLファイルを生成できます。
					テンプレートファイルの名前は、「生成したいsqlファイル名」 + 「.ftl」としてください。
				</p>
<p>
					たとえば、全件検索を行うSQLファイルselectAll.sqlを生成するには、selectAll.sql.ftlという名前のテンプレートファイルを作成します。
					テンプレートファイルには、以下のように記述します。
					（テンプレートはデータモデルとして<a href="doma-gen/apidocs/org/seasar/doma/extension/gen/SqlDesc.html">org.seasar.doma.extension.gen.SqlDesc</a>のインスタンスを参照します。）
				</p>
<div class="source"><pre>select
&lt;#list entityDesc.entityPropertyDescs as property&gt;
  ${property.columnName}&lt;#if property_has_next&gt;,&lt;/#if&gt;
&lt;/#list&gt;
from
  ${entityDesc.tableName}</pre>
</div>
<p>
					selectAll.sql.ftlは、templateFilePrimaryDir属性に指定するディレクトリに配置します。
					mytemplateディレクトリに配置する場合、templatePrimaryDir属性にmytemplateを指定します。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;
    templatePrimaryDir=&quot;mytemplate&quot;&gt;
    &lt;sqlConfig
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
<p>
					このように、独自のSQLファイルを生成する場合、SQLファイルに対応するDaoメソッドについても生成するとよいでしょう。
					Daoメソッドを生成するには、Daoインタフェースのテンプレートであるdao.ftlを修正し、templateFilePrimaryDir属性に指定するディレクトリに配置します。
				</p>
</div>
<div class="section"><h3><a name="生成するJavaファイルに共通のヘッダーとしてコピーライトを含める"></a>生成するJavaファイルに共通のヘッダーとしてコピーライトを含める</h3>
<p>
					lib.ftlというファイルを作成し、これをtemplatePrimaryDir属性に指定するディレクトリに配置します。
					lib.ftlには次のようにcopyrightの定義をします。
<div class="source"><pre>&lt;#assign copyright&gt;
/*
 * Copyright 2008-2009 ...
 * All rights reserved.
 */
&lt;/#assign&gt;</pre>
</div>

					mytemplate/lib.ftlと配置する場合、タスクの定義は次のようになります。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;
    templatePrimaryDir=&quot;mytemplate&quot;&gt;
    &lt;entityConfig
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
</div>
<div class="section"><h3><a name="生成するJavaファイルにauthorを指定する"></a>生成するJavaファイルにauthorを指定する</h3>
<p>
					lib.ftlというファイルを作成し、これをtemplatePrimaryDir属性に指定するディレクトリに配置します。
					lib.ftlには次のようにauthorの定義をします。
<div class="source"><pre>&lt;#assign author=&quot;Nakamura&quot;&gt;</pre>
</div>

					mytemplate/lib.ftlと配置する場合、タスクの定義は次のようになります。
				</p>
<div class="source"><pre>&lt;gen
    dialectName=&quot;${dialectName}&quot;
    driverClassName=&quot;${driverClassName}&quot;
    url=&quot;${url}&quot;
    user=&quot;${user}&quot;
    password=&quot;${password}&quot;
    templatePrimaryDir=&quot;mytemplate&quot;&gt;
    &lt;entityConfig
        ...
    /&gt;
&lt;gen/&gt;</pre>
</div>
</div>
</div>

</div><!-- article -->

</div><!-- contents_center -->

<div id="footer">
<address>  &copy; Copyright 
                    <a href="http://www.seasarfoundation.org/">The Seasar Foundation</a>.
            and the others
    
              2009-2014,
        all rights reserved.
  <a href="http://www.seasar.org">The Seasar Project</a>.
</address>
<div class="line"><span class="hide">spacer</span></div>
</div><!-- footer -->

</div><!-- wrapper -->

</body>
</html>
